<% title "LLF x Popular Media" %>

<%= render :partial => "banner" %>

<div id="md_wrap" class="pop_wrap_m">

  <div id="sb_wrap" class="">

    <% if @facet != nil || @query != nil %>

      <div id="bc_wrap" class="q_bc m3">
          <div class="breadcrumbs">
              <span class="mda"><%= link_to "Media", media_path %></span>
              &raquo; <span class="mda"><%= link_to "Popular", popular_media_path %></span>
              &raquo; <span>Discover</span>
          </div>

          <% if member_signed_in? %>
            <div class="add_md">
              <%= link_to "#media_index", :data => {:toggle => "modal"}, title: 'Add Media', alt: 'Add Media' do %>
                <i class="fa fa-plus"></i>Add Media
              <% end %>
            </div>
          <% end %>

          <% if member_signed_in? %>
            <%= render :partial => "pop_search" %>
          <% else %>
            <span class="l_o"><%= render :partial => "pop_search" %></span>
          <% end %>
          
      </div>

    <% else %>

      <div id="bc_wrap" class="q_bc m2">
          <div class="breadcrumbs">
              <span class="mda"><%= link_to "Media", media_path %></span> &raquo; <span>Popular</span>
          </div>

          <% if member_signed_in? %>
            <div class="add_md">
              <%= link_to "#media_index", :data => {:toggle => "modal"}, title: 'Add Media', alt: 'Add Media' do %>
                <i class="fa fa-plus"></i>Add Media
              <% end %>
            </div>
          <% end %>

          <% if member_signed_in? %>
            <%= render :partial => "pop_search" %>
          <% else %>
            <span class="l_o"><%= render :partial => "pop_search" %></span>
          <% end %>

      </div>

    <% end %>

     <div class="btags top">
        <% for row in @search.facet(:marker_list).rows %>
            <span class="btag"><%= link_to('+ ' + row.value, params.merge({:tag => row.value}), title: row.value, alt: row.value) %></span>
        <% end %>
      </div>

  </div>

  <div id="stream_filters" class="form-inline">
        <span class="filters all">
            <label for="filter__">
            <%= radio_button_tag(:filter, "*", :checked => 'checked') %> All
            </label>
        </span>
        <span class="filters photos">
            <label for="filter_.photo_fil">
            <%= radio_button_tag(:filter, ".photo_fil") %> Photos
            </label>
        </span>
        <span class="filters audio">
            <label for="filter_.audio_fil">
            <%= radio_button_tag(:filter, ".audio_fil") %> Audio
            </label>
        </span>
        <span class="filters video">
            <label for="filter_.video_fil">
            <%= radio_button_tag(:filter, ".video_fil") %> Video
            </label>
        </span>
  </div>

  <div id="media_query_media">
      <div id="m_fav_list_wrap">

        <% if @facet == nil && @query == nil %>

          <%= render partial: 'media', :collection => @media, :as => :medium %>

        <% else %>

          <%= render partial: 'results', :collection => @results, :as => :medium %>

        <% end %>

      </div>
  </div>

  <% if @facet != nil || @query != nil %>
      <%= will_paginate @results, class: 'display_none' %>

      <% if @results.total_pages != @results.current_page %>
        <div id="loading"></div>
        <%= link_to("#", class: "com_show_wrap load_arrow") do %>
              <div class="com_show">
                Show More
              </div>
            <% end %>
      <% end %>
  <% else %>
    <%= will_paginate @media, class: 'display_none' %>

    <% if @media.total_pages != @media.current_page %>
      <div id="loading"></div>
      <%= link_to("#", class: "com_show_wrap load_arrow") do %>
            <div class="com_show">
              Show More
            </div>
          <% end %>
    <% end %>
  <% end %>

  <% if member_signed_in? %>
    <div id="md_form_<%= current_member.id %>">
        <%= render :partial => "media/index_modal" %>
    </div>
  <% end %>

</div>